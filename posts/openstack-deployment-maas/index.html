<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="google-site-verification" content="NqibrxbTQ3FPfyJuuSPcSi39c5Qiqf57zoBYqWxd2dg" /><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="OpenStack Deployment - MAAS" /><meta property="og:locale" content="en_US" /><meta name="description" content="Controller OS One server that isn’t part of the OpenStack cluster (but is on the same network) needs to be the designated “MAAS Controller”. The MAAS Controller will “manage” the hardware (servers), meaning it can power on/off + deploy operating system images to each of the servers networked in the OpenStack cluster. Installing the Operating System Though most Debian Linux distributions would work, our MAAS Controller runs Ubuntu Server Focal 20.04 LTS. A Few Pointers For troubleshooting purposes, it is advisable to manually assign an IP during the installation of Ubuntu rather than automatically using DHCP. The reason why, is if the DHCP service within MAAS stops working, the MAAS controller won’t have an IP, and you won’t be able to SSH into it - and that brings up the next point below." /><meta property="og:description" content="Controller OS One server that isn’t part of the OpenStack cluster (but is on the same network) needs to be the designated “MAAS Controller”. The MAAS Controller will “manage” the hardware (servers), meaning it can power on/off + deploy operating system images to each of the servers networked in the OpenStack cluster. Installing the Operating System Though most Debian Linux distributions would work, our MAAS Controller runs Ubuntu Server Focal 20.04 LTS. A Few Pointers For troubleshooting purposes, it is advisable to manually assign an IP during the installation of Ubuntu rather than automatically using DHCP. The reason why, is if the DHCP service within MAAS stops working, the MAAS controller won’t have an IP, and you won’t be able to SSH into it - and that brings up the next point below." /><link rel="canonical" href="https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/" /><meta property="og:url" content="https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/" /><meta property="og:site_name" content="Institute for Pervasive Cybersecurity" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-27T14:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OpenStack Deployment - MAAS" /><meta name="twitter:site" content="@boisestate" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Controller OS One server that isn’t part of the OpenStack cluster (but is on the same network) needs to be the designated “MAAS Controller”. The MAAS Controller will “manage” the hardware (servers), meaning it can power on/off + deploy operating system images to each of the servers networked in the OpenStack cluster. Installing the Operating System Though most Debian Linux distributions would work, our MAAS Controller runs Ubuntu Server Focal 20.04 LTS. A Few Pointers For troubleshooting purposes, it is advisable to manually assign an IP during the installation of Ubuntu rather than automatically using DHCP. The reason why, is if the DHCP service within MAAS stops working, the MAAS controller won’t have an IP, and you won’t be able to SSH into it - and that brings up the next point below.","headline":"OpenStack Deployment - MAAS","dateModified":"2021-06-17T04:38:05+00:00","datePublished":"2021-01-27T14:00:00+00:00","url":"https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/"},"@context":"https://schema.org"}</script><title>OpenStack Deployment - MAAS | Institute for Pervasive Cybersecurity</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Institute for Pervasive Cybersecurity"><meta name="application-name" content="Institute for Pervasive Cybersecurity"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/BSU-Cybersecurity/BSU-Cybersecurity.github.io@main/assets/img/favicon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Institute for Pervasive Cybersecurity</a></div><div class="site-subtitle font-italic">A leader of innovative cybersecurity research and advancement in Idaho and the region.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/bsu-cybersecurity" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/boisestate" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cyberinstitute','boisestate.edu'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>OpenStack Deployment - MAAS</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>OpenStack Deployment - MAAS</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Institute for Pervasive Cybersecurity </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jan 27, 2021, 2:00 PM +0000" >Jan 27<i class="unloaded">2021-01-27T14:00:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 16, 2021, 10:38 PM -0600" >Jun 16<i class="unloaded">2021-06-17T04:38:05+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1542 words">8 min read</span></div></div><div class="post-content"><h1 id="controller-os">Controller OS</h1><p>One server that isn’t part of the OpenStack cluster (but is on the same network) needs to be the designated “MAAS Controller”. The MAAS Controller will “manage” the hardware (servers), meaning it can power on/off + deploy operating system images to each of the servers networked in the OpenStack cluster.</p><h2 id="installing-the-operating-system">Installing the Operating System</h2><p>Though most Debian Linux distributions would work, our MAAS Controller runs Ubuntu Server Focal 20.04 LTS.</p><h2 id="a-few-pointers">A Few Pointers</h2><ul><li>For troubleshooting purposes, it is advisable to manually assign an IP during the installation of Ubuntu rather than automatically using DHCP. The reason why, is if the DHCP service within MAAS stops working, the MAAS controller won’t have an IP, and you won’t be able to SSH into it - and that brings up the next point below.</ul><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><ul><li>It is infinitely easier to manage the MAAS Controller over SSH, however, Ubuntu Server comes out of the box with UFW, so SSH needs to be allowed through the firewall. To allow ssh, input the following command.<div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ufw allow ssh
</pre></table></code></div></div></ul><h1 id="installation">Installation</h1><p>With Ubuntu configured on the MAAS Controller, the MAAS application needs to be installed using the Snap Store by inputting this command:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>snap <span class="nb">install</span> <span class="nt">--channel</span><span class="o">=</span>2.9/stable maas
</pre></table></code></div></div><p>MAAS needs a database backend, which can be installed using the following commands.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt update <span class="nt">-y</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> postgresql
</pre></table></code></div></div><p>A user for the database then needs to be created. Input the following command - the $VARIABLE’s need to be replaced appropriately and documented for future reference.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo</span> <span class="nt">-u</span> postgres psql <span class="nt">-c</span> <span class="s2">"CREATE USER </span><span class="se">\"</span><span class="nv">$MAAS_DBUSER</span><span class="se">\"</span><span class="s2"> WITH ENCRYPTED PASSWORD '</span><span class="nv">$MAAS_DBPASS</span><span class="s2">'"</span>
</pre></table></code></div></div><p>Then the database needs to be created with the user created above. Run the following command replacing the $VARIABLE’s.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo</span> <span class="nt">-u</span> postgres createdb <span class="nt">-O</span> <span class="s2">"</span><span class="nv">$MAAS_DBUSER</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$MAAS_DBNAME</span><span class="s2">"</span>
</pre></table></code></div></div><p>A postgres config file now needs to be edited to reflect the new database user and database name. At the time of writing this guide, the latest stable version of postgres is version 12, so the following command will use vim to open the file in this directory - <code class="language-plaintext highlighter-rouge">/etc/postgresql/12/main/pg_hba.conf</code> using root privilege. In the event this doesn’t work, manually navigate to this directory, you likely have a different version of postgres installed so the ‘12’ in the directory may be a different number.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>vim /etc/postgresql/12/main/pg_hba.conf
</pre></table></code></div></div><p>With the <code class="language-plaintext highlighter-rouge">pg_hba.conf</code> file open, add the following line at the end, and save the file.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>host    <span class="nv">$MAAS_DBNAME</span>    <span class="nv">$MAAS_DBUSER</span>    0/0     md5
</pre></table></code></div></div><p>Now it is time to initialize the MAAS application using the command below. Replace the variables as appropriate, and since we are running the MAAS application on our MAAS Controller, the <code class="language-plaintext highlighter-rouge">$HOSTNAME</code> should be set to <code class="language-plaintext highlighter-rouge">localhost</code>.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>maas init region+rack <span class="nt">--database-uri</span> <span class="s2">"postgres://</span><span class="nv">$MAAS_DBUSER</span><span class="s2">:</span><span class="nv">$MAAS_DBPASS</span><span class="s2">@</span><span class="nv">$HOSTNAME</span><span class="s2">/</span><span class="nv">$MAAS_DBNAME</span><span class="s2">"</span>
</pre></table></code></div></div><p>Note that the IP of the web GUI is printed out on the terminal during this step. Press enter unless you want to make any changes. If you specified that the <code class="language-plaintext highlighter-rouge">$HOSTNAME</code> was <code class="language-plaintext highlighter-rouge">localhost</code>, the IP of the web GUI is the same as that of the MAAS Controller machine.</p><p>Finally, a MAAS admin user needs to be created.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>maas createadmin
</pre></table></code></div></div><p>You will be prompted to input user credentials - these will be used to log into the web GUI so make sure to document these for future use.</p><p>Now check the status of the MAAS application using the following command</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>maas status
</pre></table></code></div></div><p>The output should be similar to the following.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>maas status
bind9                        RUNNING   pid 22236, <span class="nb">uptime </span>0:01:02
dhcpd                        STOPPED   Not started
dhcpd6                       STOPPED   Not started
http                         RUNNING   pid 22461, <span class="nb">uptime </span>0:00:42
ntp                          RUNNING   pid 22372, <span class="nb">uptime </span>0:00:45
proxy                        RUNNING   pid 22604, <span class="nb">uptime </span>0:00:34
rackd                        RUNNING   pid 22241, <span class="nb">uptime </span>0:01:02
regiond                      RUNNING   pid 22248, <span class="nb">uptime </span>0:01:02
syslog                       RUNNING   pid 22366, <span class="nb">uptime </span>0:00:45

</pre></table></code></div></div><p>If any services are not running, follow this process to re-initialize MAAS.</p><p>At this point the MAAS web GUI should be accessible from a web browser on a machine sharing the same network as the MAAS Controller.</p><h1 id="initial-set-up">Initial Set-Up</h1><p>Access the MAAS web GUI from your local browser. You should be able to access it as long as you are on the same network as the MAAS Controller and MAAS is running. <img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>Log in to the MAAS web GUI and follow the set-up process. The steps are mostly straight-forward.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><h2 id="import-ssh-keys">Import SSH Keys</h2><p>In the next step of the initial set-up, you will be asked to input an ssh-key so that you can ssh into the machines MAAS deploys using RSA key authentication instead of a password. Grab the machine you intend to use to SSH into the MAAS-deployed nodes and retrieve the RSA key pair of that machine. If you are on a Linux machine and you have already generated SSH keys, the key can usually be retrieved from the default directory by entering the following command.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo cat</span> /home/<span class="nv">$USERNAME</span>/.ssh/id_rsa.pub
</pre></table></code></div></div><p>More than likely though, you will need to generate your “private/public key pair”. To generate the RSA key pair enter the following command. Follow the shell prompts and take note of the directory and passphrase (if any) used.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096
</pre></table></code></div></div><p>If you saved the RSA key pair to the default directory you will be able to retrieve your public key with the following command.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo cat</span> /home/<span class="nv">$USERNAME</span>/.ssh/id_rsa.pub
</pre></table></code></div></div><p>The output of this will look something like this:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC/2sats4R9ino4qZfNiPFL+PYAVjY6vdRP9G9KJZPyxeOhbcpUPQ88gf2TpjEhy9CICweJ9Wt71uhkyh7iL4nW2ZN1oPyF9jzJTTfxPyAGjV6cOOPC1ispOgmFu3ZklGpRXAaNYsgIpp5FGGyioIAatzDuBjHffYEEXqmj6qkamRhCZZdMl7EBxa0rwsTlOfdY72ohpqwqUQr6QFMpvnSO1VFTjQJIXSvpDBigdhYsL0TxH+4S9UG+ywBQunhaOpX34Z6bIQT1rfZbDEfMh/C6qcQQSFghclhCjvqn2V7FNkiYcIuImf18xLQMnZU2NKRM9x2inhdjWUXvpihJbVzZuZ03AAm0NF1H2va3fBMJrTAXKLf4wTj1k+841+d59EVD6eUGW94p3sAzkC39FQMizv1PovFCSFFjNt5zFJWEFjMNYJWvLmx2DUnEnn7Qsmjw8U66YcI03FxWwW1sab+hbsS9y5rjOlUIDc1zjHlfRZmqf0obAghcQ852WvRYKv6TJ/WE2RQtUXg0/lJjtG70+mnrOxqAE3Pk2kT2gZumhk01VlvZCVBz8bLNdZ3r5jjEVYJ/MChQW7Uv828EtA1fayXqXLtIrYZxCPcvA99GKN3/xT0HNGWSYdrelVf0CZ207aVjJuP2mfDr5DWZ9PhXxiiz/hF6TP1abKOqNfsb8w<span class="o">==</span> controller@maas
</pre></table></code></div></div><p>You will need to copy this output and paste it into the MAAS web GUI. <img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>With the RSA public key imported, continue through the initial set-up. Once you land on the page below there are a couple things that still need to be configured. <img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><h1 id="configuration">Configuration</h1><h2 id="enable-dhcp">Enable DHCP</h2><p>This step only applies if you’ve decided to let MAAS serve DHCP, as described in the Serving DHCP section of this guide.</p><p>To enable DHCP click on the “Controllers” tab at the top, and select the controller (called maas.maas in this case). <img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>In here click on “VLANs” and click on “VLAN” “untagged”.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>Scroll down to the DHCP section and click on “Enable DHCP”.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>Now, click on “Configure DHCP”</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>At this point DHCP is configured.</p><h2 id="configure-dns">Configure DNS</h2><p>Early in our deployment we encountered some issues where MAAS would commission the servers but the servers would not be able to reach the internet to install APT packages. We figured out that, though we had specified the DNS during the initial set-up process, we also needed to specify the DNS within the controller VLAN itself. To set this up go to the “Controllers” tab in the MAAS web GUI, and select your MAAS controller (“maas.maas” in this case).</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>After selecting the controller from the list, click on “VLANs” and then click on the subnet listed under “subnets” (in this case it is “192.168.1.0/24”).</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>Now, find “Subnet summary” and click on “Edit”.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>Specify the appropriate DNS in the DNS text field and click “Save summary”.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><h2 id="disable-maas-proxy">Disable MAAS Proxy</h2><p>MAAS uses a proxy to download boot images and provision packages for APT and YUM. This has caused issues in our environment where MAAS does not see the hardware inventory of our nodes and, though it manages to “enlist” the nodes, it fails to deploy them. To disable the proxy from the web GUI, go to the “Settings” tab at the top and click the “Proxy” section on the left hand side. Then select the “Don’t use a proxy” option.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>With DHCP handled, proxy disabled, and DNS properly configured, you are now ready to enlist nodes.</p><h2 id="enlisting-nodes-maas-serving-dhcp">Enlisting Nodes (MAAS serving DHCP)</h2><p>Enlisting a node when MAAS is serving DHCP is very simple. All you have to do to is power the server on - as long as it is on the same network as the MAAS Controller, and IPMI + PXE boot are properly configured (as specified in Hardware Configuration), the node will boot under MAAS instruction and will be listed in the web GUI under “Machines” as shown below. Once the node is enlisted and in “New” state, the physical machine will power down.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>It can be challenging to identify what physical node corresponds to each machine listed in the MAAS web GUI (especially if the nodes have similar hardware configuration), so it is best to enlist one node at a time.</p><p>When enlisting each node, wait until MAAS says the node is in a “New” state. At that point click on the node and on the top left corner rename it to make it more easily identifiable in the future. In this case we are naming this node “juju” since it will be the JuJu Controller node.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>Next, click on the “Configuration” tab, add the appropriate tag to each node. The JuJu Controller needs to be tagged “juju” and the nodes that will be used as compute nodes need to be tagged “compute”.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>With nodes renamed, tagged and in “New” state, the list of Machines on the MAAS web GUI should look something like this.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>Now the machines are ready to be “Commissioned”. To do this select all the machines and click on the green “Take Action” button, then click on “Commission”, and “Start commissioning machines”.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><p>This process will take some time but once the machines are in a “Ready” state you can work on deploying the JuJu Controller and Compute nodes.</p><p><img data-proofer-ignore data-src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/posts/20190808/window.png" alt="Shadow Avatar" class="shadow" width="90%" /></p><h1 id="next-section-juju"><a href="https://bsu-cybersecurity.github.io/posts/openstack-deployment-juju/">Next Section: JuJu</a></h1></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/training-soc/'>Training-SOC</a>, <a href='/categories/openstack/'>OpenStack</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/openstack/" class="post-tag no-text-decoration" >openstack</a> <a href="/tags/cloud/" class="post-tag no-text-decoration" >cloud</a> <a href="/tags/deployment/" class="post-tag no-text-decoration" >deployment</a> <a href="/tags/soc/" class="post-tag no-text-decoration" >soc</a> <a href="/tags/guide/" class="post-tag no-text-decoration" >guide</a> <a href="/tags/charms/" class="post-tag no-text-decoration" >charms</a> <a href="/tags/juju/" class="post-tag no-text-decoration" >juju</a> <a href="/tags/maas/" class="post-tag no-text-decoration" >maas</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OpenStack Deployment - MAAS - Institute for Pervasive Cybersecurity&url=https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OpenStack Deployment - MAAS - Institute for Pervasive Cybersecurity&u=https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=OpenStack Deployment - MAAS - Institute for Pervasive Cybersecurity&url=https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', '')" data-toggle="tooltip" data-placement="top" title=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/training-soc-Security-Onion-Host-Agents/">Security Onion - Host Agents</a><li><a href="/posts/Virtual-City-Network-Design/">Virtual City Network Design</a><li><a href="/posts/training-soc-tools-pfsense/">Tools - PfSense</a><li><a href="/posts/security-onion-deployment/">Security Onion Deployment</a><li><a href="/posts/proxmox-networking-SDN/">Proxmox - SDN</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/soc/">soc</a> <a class="post-tag" href="/tags/guide/">guide</a> <a class="post-tag" href="/tags/deployment/">deployment</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/openstack/">openstack</a> <a class="post-tag" href="/tags/juju/">juju</a> <a class="post-tag" href="/tags/maas/">maas</a> <a class="post-tag" href="/tags/charms/">charms</a> <a class="post-tag" href="/tags/client/">client</a> <a class="post-tag" href="/tags/tools/">tools</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/openstack-deployment-debugging/"><div class="card-body"> <span class="timeago small" >Jan 22<i class="unloaded">2021-01-22T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenStack Deployment - Debugging</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/posts/openstack-deployment-management/"><div class="card-body"> <span class="timeago small" >Jan 23<i class="unloaded">2021-01-23T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenStack Deployment - Management</h3><div class="text-muted small"><p> Next Section: Debugging</p></div></div></a></div><div class="card"> <a href="/posts/openstack-deployment-configuration/"><div class="card-body"> <span class="timeago small" >Jan 24<i class="unloaded">2021-01-24T14:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenStack Deployment - Configuration</h3><div class="text-muted small"><p> Next Section: Management</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/openstack-deployment-juju/" class="btn btn-outline-primary" prompt="previous"><p>OpenStack Deployment - JuJu</p></a> <a href="/posts/openstack-deployment-network/" class="btn btn-outline-primary" prompt="next"><p>OpenStack Deployment - Network</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'OpenStack Deployment - MAAS'; this.page.url = 'https://bsu-cybersecurity.github.io//posts/openstack-deployment-maas/'; this.page.identifier = '/posts/openstack-deployment-maas/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/boisestate">Institute for Pervasive Cybersecurity</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the guides on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by Boise State University.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/soc/">soc</a> <a class="post-tag" href="/tags/guide/">guide</a> <a class="post-tag" href="/tags/deployment/">deployment</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/openstack/">openstack</a> <a class="post-tag" href="/tags/juju/">juju</a> <a class="post-tag" href="/tags/maas/">maas</a> <a class="post-tag" href="/tags/charms/">charms</a> <a class="post-tag" href="/tags/client/">client</a> <a class="post-tag" href="/tags/tools/">tools</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://BSU-Cybersecurity.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
